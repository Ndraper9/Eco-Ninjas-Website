<!--
  ══════════════════════════════════════════════════════════
  ECO NINJAS — NEWSLETTER SIGNUP COMPONENT
  Drop this block anywhere on any page (before </body>)
  ══════════════════════════════════════════════════════════
-->

<!-- NEWSLETTER BAND CSS — add once to <style> block of each page -->
<style>
  .newsletter-band { background: var(--green-deep); padding: 56px 0; position: relative; overflow: hidden; }
  .newsletter-band::before { content: ''; position: absolute; inset: 0; background: radial-gradient(ellipse 60% 80% at 90% 50%, rgba(76,175,125,0.1) 0%, transparent 60%); pointer-events: none; }
  .newsletter-inner { max-width: 1200px; margin: 0 auto; padding: 0 40px; display: grid; grid-template-columns: 1fr 480px; gap: 60px; align-items: center; position: relative; }
  .newsletter-label { font-size: 0.68rem; font-weight: 700; letter-spacing: 0.18em; text-transform: uppercase; color: var(--green-light); margin-bottom: 10px; }
  .newsletter-title { font-family: 'Playfair Display', serif; font-size: 1.7rem; font-weight: 700; color: #fff; line-height: 1.2; margin-bottom: 10px; }
  .newsletter-sub { font-size: 0.9rem; color: #7aab8e; line-height: 1.65; }
  .newsletter-form { display: flex; flex-direction: column; gap: 12px; }
  .newsletter-row { display: flex; gap: 10px; }
  .newsletter-input { flex: 1; padding: 13px 16px; border: 1px solid rgba(76,175,125,0.3); border-radius: 8px; background: rgba(255,255,255,0.06); color: #fff; font-family: 'DM Sans', sans-serif; font-size: 0.88rem; outline: none; transition: border-color 0.2s, background 0.2s; }
  .newsletter-input::placeholder { color: rgba(255,255,255,0.35); }
  .newsletter-input:focus { border-color: var(--green-light); background: rgba(255,255,255,0.1); }
  .newsletter-btn { padding: 13px 22px; background: var(--green-light); color: var(--green-deep); border: none; border-radius: 8px; font-size: 0.88rem; font-weight: 700; cursor: pointer; white-space: nowrap; transition: all 0.2s; font-family: 'DM Sans', sans-serif; }
  .newsletter-btn:hover:not(:disabled) { background: #fff; transform: translateY(-1px); }
  .newsletter-btn:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
  .newsletter-name { width: 100%; padding: 13px 16px; border: 1px solid rgba(76,175,125,0.3); border-radius: 8px; background: rgba(255,255,255,0.06); color: #fff; font-family: 'DM Sans', sans-serif; font-size: 0.88rem; outline: none; transition: border-color 0.2s; }
  .newsletter-name::placeholder { color: rgba(255,255,255,0.35); }
  .newsletter-name:focus { border-color: var(--green-light); }
  .newsletter-note { font-size: 0.72rem; color: #5a8070; }
  .newsletter-status { font-size: 0.85rem; font-weight: 600; padding: 10px 14px; border-radius: 6px; display: none; }
  .newsletter-status.success { background: rgba(76,175,125,0.15); color: var(--green-light); display: block; }
  .newsletter-status.error   { background: rgba(224,90,43,0.15); color: #f08060; display: block; }
  @media (max-width: 900px) { .newsletter-inner { grid-template-columns: 1fr; gap: 32px; } .newsletter-row { flex-direction: column; } }
  @media (max-width: 640px) { .newsletter-inner { padding: 0 20px; } }
</style>

<!-- NEWSLETTER BAND HTML — paste where you want the band to appear -->
<section class="newsletter-band">
  <div class="newsletter-inner">
    <div>
      <p class="newsletter-label">Stay Informed</p>
      <h2 class="newsletter-title">NHS Sustainability &amp; Theatre Safety Updates</h2>
      <p class="newsletter-sub">New research, case studies, NHS policy updates and product news — delivered to your inbox. No spam, unsubscribe any time.</p>
    </div>
    <div class="newsletter-form" id="newsletterForm">
      <input type="text" class="newsletter-name" id="nl-name" placeholder="Your name (optional)" />
      <div class="newsletter-row">
        <input type="email" class="newsletter-input" id="nl-email" placeholder="your@nhs.net" required />
        <button class="newsletter-btn" type="button" onclick="subscribeNewsletter(this)">Subscribe →</button>
      </div>
      <p class="newsletter-note">Your email is only used to send Eco Ninjas updates. See our privacy policy.</p>
      <div class="newsletter-status" id="nl-status"></div>
    </div>
  </div>
</section>

<!-- NEWSLETTER JS — add once per page (or move to a shared script) -->
<script>
  async function subscribeNewsletter(btn) {
    const API_BASE = 'https://your-railway-app.railway.app'; // ← update after Railway deploy
    const email = document.getElementById('nl-email').value.trim();
    const name  = document.getElementById('nl-name').value.trim();
    const status = document.getElementById('nl-status');

    if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
      status.className = 'newsletter-status error';
      status.textContent = '⚠ Please enter a valid email address.';
      return;
    }

    btn.disabled = true;
    btn.textContent = 'Subscribing...';
    status.className = 'newsletter-status';

    try {
      const res = await fetch(API_BASE + '/api/newsletter', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ name, email, source: window.location.pathname })
      });
      const json = await res.json();
      if (json.success) {
        status.className = 'newsletter-status success';
        status.textContent = '✓ You\'re subscribed! Check your inbox for a welcome email.';
        document.getElementById('nl-email').value = '';
        document.getElementById('nl-name').value = '';
      } else {
        throw new Error(json.message);
      }
    } catch (err) {
      status.className = 'newsletter-status error';
      status.textContent = '✗ ' + (err.message || 'Something went wrong. Please try again.');
    } finally {
      btn.disabled = false;
      btn.textContent = 'Subscribe →';
    }
  }
</script>
